<?php//set variables needed for email.$from = "wegottatalkbaby@optonline.net";$subject = "Responsible Choices Publishing Co. - File Location and Password";$msg_01 =  "Thank you for your purchase of \"We Gotta Talk, Baby: Making Responsible Choices in the 21st Century\"from Responsible Choices Publishing Co.\n\nYour book will ship within 1 to 2 weeks of your order to the address you provided with yourtransaction.\n\nIf you have any problems, please contact us at wegottatalkbaby@optonline.net";$msg_02 =  "Thank you for your purchase of from Responsible Choices Publishing Co.\n\nPlease keep this information in a safe place, as it contains pertinent information for obtaining the forms you have purchased.\n\nLink to file Notice of Pregnancy:\nhttp://www.wegottatalkbaby.com/paypal/np.pdf\n\nPassword:\n581486189001\n\nIf you have any problems, please contact us at wegottatalkbaby@optonline.net";$msg_03 =  "Thank you for your purchase from Responsible Choices Publishing Co.\n\nPlease keep this information in a safe place, as it contains pertinent information for obtaining the forms you have purchased.\n\nLink to file Response to Notice of Pregnancy:\nhttp://www.wegottatalkbaby.com/paypal/rnp.pdf\n\nPassword:\n491007825065\n\nIf you have any problems, please contact us at wegottatalkbaby@optonline.net";$msg_04 =  "Thank you for your purchase from Responsible Choices Publishing Co.\n\nPlease keep this information in a safe place, as it contains pertinent information for obtaining the forms you have purchased.\n\nLink to file Notice of Pregnancy:\nhttp://www.wegottatalkbaby.com/paypal/np.pdf\n\nPassword:\n581486189001\n\nLink to file Response to Notice of Pregnancy:\nhttp://www.wegottatalkbaby.com/paypal/rnp.pdf\n\nPassword:\n491007825065\n\nIf you have any problems, please contact us at wegottatalkbaby@optonline.net";// read the post from PayPal system and add 'cmd'$req = 'cmd=_notify-validate';foreach ($_POST as $key => $value) {$value = urlencode(stripslashes($value));$req .= "&$key=$value";}// post back to PayPal system to validate$header .= "POST /cgi-bin/webscr HTTP/1.0\r\n";$header .= "Content-Type: application/x-www-form-urlencoded\r\n";$header .= "Content-Length: " . strlen($req) . "\r\n\r\n";$fp = fsockopen ('www.paypal.com', 80, $errno, $errstr, 30);if (!$fp) {// HTTP ERROR} else {fputs ($fp, $header . $req);while (!feof($fp)) {$res = fgets ($fp, 1024);if (strcmp ($res, "VERIFIED") == 0) {// check the payment_status is Completed// check that txn_id has not been previously processed// check that receiver_email is your Primary PayPal email// check that payment_amount/payment_currency are correct// process payment// if 'VERIFIED', send email	if ($item_number1 == 'RCP1101')	{mail($payer_email, "Responsible Choices Publishing Co. - Order Confirmation", $msg_01, "From: $from");}	elseif ($item_number1  == 'RCP1102')	{mail($payer_email, $subject, $msg_02, "From: $from");}	elseif ($item_number1  == 'RCP1103')	{mail($payer_email, $subject, $msg_03, "From: $from");}	elseif ($item_number1  == 'RCP1104')	{mail($payer_email, $subject, $msg_04, "From: $from");}	else 	{mail("remix.sakura@gmail.com", "rcpc error message", "$req", "From: $from");}}else if (strcmp ($res, "INVALID") == 0) {// log for manual investigation}  }fclose ($fp);}?>